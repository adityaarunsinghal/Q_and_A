---
title: "Untitled"
output: html_document
---

To analyze the output of a webppl program for bayesian data analysis

```{r}
setwd("/Users/rxdh/Box Sync/stanford/research/goodman/q&a/modeling")

library(coda)
library(purrr)
estimate_mode <- function(s) {
  d <- density(s)
  return(d$x[which.max(d$y)])
}
HPDhi<- function(s){
  m <- HPDinterval(mcmc(s))
  return(m["var1","upper"])
}
HPDlo<- function(s){
  m <- HPDinterval(mcmc(s))
  return(m["var1","lower"])
}
options("scipen"=10) 
```

### Load in model results

```{r}
m<-read.csv("guessingGame/Bayesian/BayesianQuestionerAnalysisParams.csv", sep = ",", row.names = NULL)
samples = 1000
str(m)
m.samples <- m[rep(row.names(m), m$prob*samples), 1:6]

```

```{r}
ggplot(m.params, aes(x=prob))+
    geom_histogram(binwidth = .1)+
    facet_wrap(~parameter, scales='free')
```